
# 对象-关系 阻抗不匹配（Object–relational impedance mismatch）

>翻译自 [维基百科](https://en.wikipedia.org/wiki/Object–relational_impedance_mismatch)

​    阻抗不匹配是一个理论和技术的双重难题，通常出现在关系型数据库管理系统（RDBMS）为一个或多个应用程序提供服务的时候，而这个服务的编写语言是面向对象的语言或者风格，主要是因为对象或类的定义必须映射到一个由关系型模型定义的数据表中。

​    这个术语（object–relational impedance mismatch）起源于电器工程的阻抗不匹配（impedance matching）。

## 不匹配

​    对象是彼此引用，然后形成一个数学概念上的图（由各种循环组成的网络），关系模型是相反的、表格式的、基于关系代数的，它定义了相关联的各式各样的元组（这些元组是不同类型的字段组成的行的分组）

### 面向对象概念

#### 封装

​    这种设计精良的面向对象的程序会导致对象都是封装好的，从而对象的内部信息被隐藏起来。在面向对象架构中，对象的这种潜在属性不希望暴露给外面任何接口。但是，大多数对象关系映射并没有明确指定如何将对象的潜在内容与对象的具体实现互动。因此，对象关系映射违反了对象的封装原则，自从许多对象关系映射自动生成与数据库字段对应的公共字段。另外还有少量框架利用元编程的技术避免了违反封装原则。

#### 可达性

​    在关系型的思想中，私有和公共的访问是相对都需要的。在面向对象的模型中，这是数据状态的绝对的特征。关系模型和面向对象模型经常在分类和特征的相对性和绝对性上发生冲突。

#### 接口，类，继承，多态

​    在面向对象范式中，对象通过接口提供对该对象内部的唯一访问。另一方面，在关系型模型中，利用派生关系变量（视图）提供不同的视角和约束，以确保完整性。类似地，关系数据库系统也不支持对象类的基本OOP概念（继承和多态）。

#### 映射到关系理念

​    如果将关系数据库表链接到在面向对象分析中发现的关联，则可以在关系概念和面向对象概念之间进行适当的映射。

### 数据类型差异

​    现有关系语言和OO语言之间的一个主要不匹配是类型系统的差异。关系模型严格禁止引用属性（或指针），然而，面向对象语言接受并期望这种引用行为。另外，标量类型和它们的操作符语义在模型之间可能有很大的不同，从而导致映射问题。
​    例如，大多数SQL系统都支持具有不同排序规则和受限最大长度的字符串类型（开放式文本类型往往会影响性能）。与此同时大多数OO语言只将排序规则视为排序例程的参数，字符串的大小本质上是根据可用内存来确定的。一个更微妙但相关的例子是，为了进行比较，SQL系统通常忽略字符串中的尾随空格，而OO字符串库则没有。在OO语言中，通常不可能通过约束其他原始类型的可能值来构造新的数据类型。

### 结构和完整性差异

​    另一个不匹配是结构和完整性方面的。在OO语言中，对象通常可以由其他对象组成，或者从更一般的高纬度或专业定义中组成。这可能会使到关系模式的映射变得不那么简单。这是因为关系数据倾向于表示成全局的一组带命名的集合，非嵌套的关系变量。关系本身，即所有元组的集合都符合相同的头（参见元组关系演算），在OO语言中没有理想的对应关系。OO语言中的约束通常不是这样声明的，而是表现为一些保护逻辑，这些保护逻辑是围绕对封装的内部数据进行操作的代码引发的异常的保护逻辑。另一方面，关系模型要求对标量类型、属性、关系变量和整个数据库进行声明性约束。

### 操作性差异

​    然而，语义差异在对比模型的操作方面尤为明显。关系模型有一组固有的、相对较小的、定义良好的原始运算符，用于数据的查询和操作，而OO语言通常通过定制的或较低级别的、特定的和物理访问路径的命令式操作来处理查询和操作。有些面向对象语言确实支持声明式查询子语言，但是因为OO语言通常用来处理列表，也许还有哈希表，操纵原语必然不同于关系模型的基于集合的操作。

### 事务差异

​    并发和事务方面也有很大的不同。特别是，事务，这个数据库执行的最小工作单元，在关系数据库中的规模，相对于OO语言中对类执行的任何操作都要大得多。关系数据库中的事务是一个对数据进行任意操作的动态有界集合，而OO语言中事务的粒度通常是在对原始类型字段进行单独赋值的级别上。一般来说，OO语言没有类似的隔离性或持久性，所以原子性和一致性只有在写入这些原始类型的字段时才能得到保证。

## 解决阻抗不匹配

​    解决面向对象程序的阻抗不匹配问题首先要认识到所采用的特定逻辑系统的差异，然后将不匹配最小化或补偿。

### 替代体系结构

​    对象-关系阻抗不匹配问题不是OO和数据库之间的普遍问题，顾名思义，这种阻抗问题只发生在关系数据库中。这个问题最常见的解决方案是使用另一种数据库，如NoSQL或XML数据库。

### 最小化







